p8105_hw3_jd3924
================
Jiahe Deng
2022-10-12

``` r
library(readr)
library(tidyverse)
```

    ## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
    ## ✔ ggplot2 3.3.6      ✔ dplyr   1.0.10
    ## ✔ tibble  3.1.8      ✔ stringr 1.4.1 
    ## ✔ tidyr   1.2.0      ✔ forcats 0.5.2 
    ## ✔ purrr   0.3.4      
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()

``` r
library(ggridges)
```

``` r
accel_data =
  read_csv("accel_data.csv") %>%
  janitor::clean_names() %>%
  mutate(weekday_weekend= ifelse (day %in% c("Saturday","Sunday"), "weekdend", "weekday")) %>%
  select(week,day_id,day,weekday_weekend,everything()) %>%
  group_by(day_id,day) %>%
  pivot_longer(
    activity_1:activity_1440,
    names_to = "activity_min",
    values_to = "amount_of_activity",
    names_prefix = "activity_")  %>%
  mutate(activity_min = as.numeric(activity_min))
```

    ## Rows: 35 Columns: 1443
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr    (1): day
    ## dbl (1442): week, day_id, activity.1, activity.2, activity.3, activity.4, ac...
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
accel_data
```

    ## # A tibble: 50,400 × 6
    ## # Groups:   day_id, day [35]
    ##     week day_id day    weekday_weekend activity_min amount_of_activity
    ##    <dbl>  <dbl> <chr>  <chr>                  <dbl>              <dbl>
    ##  1     1      1 Friday weekday                    1               88.4
    ##  2     1      1 Friday weekday                    2               82.2
    ##  3     1      1 Friday weekday                    3               64.4
    ##  4     1      1 Friday weekday                    4               70.0
    ##  5     1      1 Friday weekday                    5               75.0
    ##  6     1      1 Friday weekday                    6               66.3
    ##  7     1      1 Friday weekday                    7               53.8
    ##  8     1      1 Friday weekday                    8               47.8
    ##  9     1      1 Friday weekday                    9               55.5
    ## 10     1      1 Friday weekday                   10               43.0
    ## # … with 50,390 more rows

``` r
accel_data %>%
  summarize(total_activity = sum(amount_of_activity)) %>%
  knitr::kable(digits = 1)
```

    ## `summarise()` has grouped output by 'day_id'. You can override using the
    ## `.groups` argument.

| day_id | day       | total_activity |
|-------:|:----------|---------------:|
|      1 | Friday    |       480542.6 |
|      2 | Monday    |        78828.1 |
|      3 | Saturday  |       376254.0 |
|      4 | Sunday    |       631105.0 |
|      5 | Thursday  |       355923.6 |
|      6 | Tuesday   |       307094.2 |
|      7 | Wednesday |       340115.0 |
|      8 | Friday    |       568839.0 |
|      9 | Monday    |       295431.0 |
|     10 | Saturday  |       607175.0 |
|     11 | Sunday    |       422018.0 |
|     12 | Thursday  |       474048.0 |
|     13 | Tuesday   |       423245.0 |
|     14 | Wednesday |       440962.0 |
|     15 | Friday    |       467420.0 |
|     16 | Monday    |       685910.0 |
|     17 | Saturday  |       382928.0 |
|     18 | Sunday    |       467052.0 |
|     19 | Thursday  |       371230.0 |
|     20 | Tuesday   |       381507.0 |
|     21 | Wednesday |       468869.0 |
|     22 | Friday    |       154049.0 |
|     23 | Monday    |       409450.0 |
|     24 | Saturday  |         1440.0 |
|     25 | Sunday    |       260617.0 |
|     26 | Thursday  |       340291.0 |
|     27 | Tuesday   |       319568.0 |
|     28 | Wednesday |       434460.0 |
|     29 | Friday    |       620860.0 |
|     30 | Monday    |       389080.0 |
|     31 | Saturday  |         1440.0 |
|     32 | Sunday    |       138421.0 |
|     33 | Thursday  |       549658.0 |
|     34 | Tuesday   |       367824.0 |
|     35 | Wednesday |       445366.0 |

``` r
accel_data %>%
  ggplot(aes(x = activity_min,y = amount_of_activity,color = day)) +
  geom_line()+
  labs(
    x = "Time / Day",
    y = "Amoung of Activity",
    title = "The Plot of Activity Time Courses for Each Day",
    caption = "Data from the accel_data.csv"
    )+
  theme(legend.position = "bottom")+
  scale_x_continuous(
    breaks = c(0,360,720,1080,1440),
    labels = c("0:00am", "6:00am", "12:00pm", "6:00pm", "24:00pm"),
    limits = c(0, 1440))
```

![](p8105_hw3_jd3924_files/figure-gfm/unnamed-chunk-4-1.png)<!-- -->
